<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>КВТ - Система измерения температуры и влажности</title>
    <link rel="stylesheet" href="css/styles.css" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div id="app">
      <header>
        <h1>КВТ - Система измерения температуры и влажности</h1>
        <nav>
          <button @click="showDashboard">Панель управления</button>
          <button @click="showSettings">Настройки</button>
          <button @click="showLogs">Логи</button>
          <button @click="openControllerSettings">Настройки контроллера</button>
        </nav>
      </header>

      <main>
        <!-- Панель управления -->
        <div v-if="currentView === 'dashboard'" class="dashboard">
          <div class="sensors-grid">
            <div v-for="sensor in sensors" :key="sensor.id" class="sensor-card">
              <h3>{{ sensor.name }}</h3>
              <div class="sensor-data">
                <div class="temperature">
                  <span>Температура:</span>
                  <span :class="{ 'warning': isTemperatureWarning(sensor) }"> {{ sensor.temperature }}°C </span>
                </div>
                <div class="humidity">
                  <span>Влажность:</span>
                  <span :class="{ 'warning': isHumidityWarning(sensor) }"> {{ sensor.humidity }}% </span>
                </div>
                <div class="status">
                  <span>Статус:</span>
                  <span :class="getStatusClass(sensor.status)"> {{ getStatusText(sensor.status) }} </span>
                </div>
              </div>
              <div class="chart-container">
                <canvas :id="'chart-' + sensor.id"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Настройки -->
        <div v-if="currentView === 'settings'" class="settings">
          <h2>Настройки системы</h2>
          <div class="settings-form">
            <div class="form-group">
              <label>Порог температуры (мин):</label>
              <input type="number" v-model="settings.temperature.min" />
            </div>
            <div class="form-group">
              <label>Порог температуры (макс):</label>
              <input type="number" v-model="settings.temperature.max" />
            </div>
            <div class="form-group">
              <label>Порог влажности (мин):</label>
              <input type="number" v-model="settings.humidity.min" />
            </div>
            <div class="form-group">
              <label>Порог влажности (макс):</label>
              <input type="number" v-model="settings.humidity.max" />
            </div>
            <button @click="saveSettings">Сохранить</button>
          </div>
        </div>

        <!-- Логи -->
        <div v-if="currentView === 'logs'" class="logs">
          <h2>Системные логи</h2>
          <div class="logs-container">
            <div v-for="log in logs" :key="log.id" class="log-entry">
              <span class="timestamp">{{ formatTimestamp(log.timestamp) }}</span>
              <span :class="['level', log.level]">{{ log.level }}</span>
              <span class="message">{{ log.message }}</span>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="js/app.js"></script>
  </body>
</html>
